{{define "content"}}
{{if eq .WaitlistStatus "success"}}
<div class="alert alert-success mb-6 max-w-5xl mx-auto">
    <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
    <span>You're on the waitlist! We'll email you when the Hosted plan is available.</span>
</div>
{{end}}
{{if eq .WaitlistStatus "error"}}
<div class="alert alert-error mb-6 max-w-5xl mx-auto">
    <span>Please enter a valid email address.</span>
</div>
{{end}}

<div class="text-center mb-8">
    <h1 class="text-4xl font-bold mb-2">Pricing</h1>
    <p class="text-lg text-base-content/60">Choose the plan that works for your household.</p>
</div>

<div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-5xl mx-auto">
    <!-- Free Plan -->
    <div class="card bg-base-100 shadow-md">
        <div class="card-body">
            <h2 class="card-title justify-center">Free</h2>
            <div class="text-center my-4">
                <span class="text-4xl font-bold">$0</span>
                <span class="text-base-content/60">/month</span>
            </div>
            <ul class="space-y-2 text-sm">
                <li class="flex items-center gap-2">
                    <svg class="w-4 h-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                    Dashboard & calendar
                </li>
                <li class="flex items-center gap-2">
                    <svg class="w-4 h-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                    Chores & grocery lists
                </li>
                <li class="flex items-center gap-2">
                    <svg class="w-4 h-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                    Notes & rewards
                </li>
                <li class="flex items-center gap-2">
                    <svg class="w-4 h-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                    Self-hosted
                </li>
            </ul>
            <div class="card-actions justify-center mt-4">
                <span class="btn btn-ghost btn-sm">Current plan</span>
            </div>
        </div>
    </div>

    <!-- Cloud Plan -->
    <div class="card bg-primary text-primary-content shadow-xl border-2 border-primary">
        <div class="card-body">
            <div class="badge badge-secondary badge-sm self-center">Most Popular</div>
            <h2 class="card-title justify-center">Cloud</h2>
            <div class="text-center my-4">
                <span class="text-4xl font-bold">$5</span>
                <span class="opacity-80">/month</span>
            </div>
            <ul class="space-y-2 text-sm">
                <li class="flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                    Everything in Free
                </li>
                <li class="flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                    Tunnel access (remote)
                </li>
                <li class="flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                    Cloud backups
                </li>
                <li class="flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                    Push notifications
                </li>
            </ul>
            <div class="card-actions justify-center mt-4">
                {{if .HasSubscription}}
                <button class="btn btn-secondary btn-sm w-full" disabled>Current Plan</button>
                {{else if .IsAuthenticated}}
                <button onclick="startCheckout('cloud')" class="btn btn-secondary btn-sm w-full">Get Started</button>
                {{else}}
                <a href="/login?redirect=/pricing" class="btn btn-secondary btn-sm w-full">Get Started</a>
                {{end}}
            </div>
        </div>
    </div>

    <!-- Hosted Plan -->
    <div class="card bg-base-100 shadow-md">
        <div class="card-body">
            <h2 class="card-title justify-center">Hosted</h2>
            <div class="text-center my-4">
                <span class="text-4xl font-bold">$10</span>
                <span class="text-base-content/60">/month</span>
            </div>
            <ul class="space-y-2 text-sm">
                <li class="flex items-center gap-2">
                    <svg class="w-4 h-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                    Everything in Cloud
                </li>
                <li class="flex items-center gap-2">
                    <svg class="w-4 h-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                    Fully managed hosting
                </li>
                <li class="flex items-center gap-2">
                    <svg class="w-4 h-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                    Automatic updates
                </li>
                <li class="flex items-center gap-2">
                    <svg class="w-4 h-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                    Priority support
                </li>
            </ul>
            <div class="card-actions justify-center mt-4">
                <form method="POST" action="/waitlist" class="w-full">
                    <input type="hidden" name="plan" value="hosted">
                    <div class="join w-full">
                        <input type="email" name="email" placeholder="you@example.com" required class="input input-bordered input-sm join-item w-full">
                        <button type="submit" class="btn btn-outline btn-sm join-item">Join Waitlist</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{{if .IsAuthenticated}}
<script>
async function startCheckout(plan) {
    try {
        const resp = await fetch('/api/checkout', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({plan: plan})
        });
        if (!resp.ok) throw new Error('Checkout failed');
        const data = await resp.json();
        if (data.url) window.location.href = data.url;
    } catch (err) {
        alert('Unable to start checkout. Please try again.');
    }
}
</script>
{{end}}
{{end}}
